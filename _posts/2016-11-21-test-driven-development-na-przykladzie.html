---
layout: post
status: publish
published: true
title: Test Driven Development na przykładzie
author:
  display_name: Marcin Pietraszek
  login: marcin
  email: m.pietraszek@gmail.com
  url: ''
author_login: marcin
author_email: m.pietraszek@gmail.com
excerpt: "W tym artykule dowiesz się czym jest TDD (ang. <em>Test-Driven Development<&#47;em>).
  Poznasz wady i zalety takiego podejścia. Poznasz cykl &bdquo;red &ndash; green &ndash;
  refactor&rdquo; , kt&oacute;ry jest w centrum TDD. Ponadto pokażę parę przydatnych
  skr&oacute;t&oacute;w klawiaturowych, kt&oacute;re ułatwią pisanie test&oacute;w.
  Wszystko to pokażę na przykładzie prostego programu, symulującego dzienniczek ucznia.
  Będzie to także zadanie dla Ciebie, w kt&oacute;rym przećwiczysz TDD w praktyce.\r\n\r\n"
wordpress_id: 550
wordpress_url: http://www.samouczekprogramisty.pl/?p=550
date: '2016-11-21 17:48:05 +0100'
date_gmt: '2016-11-21 16:48:05 +0100'
categories:
- Kurs programowania Java
- Strefa zadaniowa
tags: []
---
<p>W tym artykule dowiesz się czym jest TDD (ang. <em>Test-Driven Development<&#47;em>). Poznasz wady i zalety takiego podejścia. Poznasz cykl &bdquo;red &ndash; green &ndash; refactor&rdquo; , kt&oacute;ry jest w centrum TDD. Ponadto pokażę parę przydatnych skr&oacute;t&oacute;w klawiaturowych, kt&oacute;re ułatwią pisanie test&oacute;w. Wszystko to pokażę na przykładzie prostego programu, symulującego dzienniczek ucznia. Będzie to także zadanie dla Ciebie, w kt&oacute;rym przećwiczysz TDD w praktyce.</p>
<p><a id="more"></a><a id="more-550"></a></p>
<p>Jeśli tematyka test&oacute;w, jest dla Ciebie nowa zachęcam Cię do przeczytania poprzedniego artykułu. W artykule tym od postaw opisuję zagadnienie <a href="http:&#47;&#47;www.samouczekprogramisty.pl&#47;testy-jednostkowe-z-junit&#47;">test&oacute;w jednostkowych<&#47;a>.</p>
<h1>Czym jest TDD<&#47;h1><br />
TDD to podejście do tworzenia oprogramowania, kt&oacute;re zostało ponownie odkryte przez Kent&rsquo;a Beck&rsquo;a. Podejście to zakłada, że przed napisaniem właściwej funkcjonalności programista zaczyna od utworzenia testu. Test ten powinien testować funkcjonalność, kt&oacute;rą dopiero chcemy napisać.</p>
<p>TDD to podejście, kt&oacute;re składa się z trzech faz. Te trzy fazy łączą się w cykl. Cały proces pisania kodu składa się z właśnie takich cykli, kt&oacute;re powtarzasz jeden po drugim. Cykl to trzy fazy:</p>
<ol>
<li>red,<&#47;li>
<li>green,<&#47;li>
<li>refactor.<&#47;li><br />
<&#47;ol></p>
<h2>Faza Red<&#47;h2><br />
Pierwszym krokiem jest napisanie testu. Test ten nie może się powieść, ponieważ sama funkcjonalność jeszcze nie jest zaimplementowana.&nbsp; Możliwe, że nawet po napisaniu takiego testu kod nie będzie się kompilował. Może się tak stać w przypadku, gdy napisałeś test dla metody, kt&oacute;ra jeszcze nie istnieje.</p>
<p>Sytuacja, w kt&oacute;rej testy jednostkowe nie przechodzą bardzo często w IDE oznaczana jest kolorem czerwonym.</p>
<h2>Faza Green<&#47;h2><br />
Kolejnym krokiem jest napisanie kodu, kt&oacute;ry implementuje brakującą funkcjonalność. W tym momencie istotne jest to aby ten kod nie był &bdquo;idealny&rdquo;. Chodzi o możliwe jak najszybszą implementację, kt&oacute;ra spełnia założenia testu, kt&oacute;ry był napisany w poprzedniej fazie.</p>
<p>Następnie potwierdzamy to, że nasza implementacja działa jak powinna uruchamiając testy jednostkowe. Jeśli wszystko jest w porządku całość powinna zakończyć się testami jednostkowymi, kt&oacute;re przechodzą. IDE sygnalizuje taką sytuację zielonym kolorem. Ważne jest aby w tej fazie uruchamiać wszystkie dotychczas napisane testy jednostkowe.</p>
<h2>Faza Refactor<&#47;h2><br />
Refaktoryzacja (ang. <em>refactor<&#47;em>) to proces, w kt&oacute;rym zmieniamy kod w taki spos&oacute;b, że nie zostaje zmieniona jego funkcjonalność. M&oacute;wi się o &bdquo;oczyszczaniu&rdquo; kodu, doprowadzaniu go do lepszego stanu. Przykładem refaktoryzacji może być wydzielenie oddzielnej metody, kt&oacute;ra usuwa zduplikowany kod czy stworzenie zupełnie nowej klasy odpowiedzialnej za pewną część zadań danej klasy.</p>
<p>Jest to ostatnia z trzech faz cyklu TDD. Faza refaktoryzacji jest bardzo istotna. Nawet doświadczeni programiści bardzo często pomijają tę fazę. Jej brak może w dłuższej perspektywie prowadzić do kodu programu, kt&oacute;ry jest trudny w utrzymaniu. Praca z takim kodem może być w&oacute;wczas dużo cięższa, proste zmiany mogą zajmować bardzo dużo czasu.</p>
<p>Dzięki testom, kt&oacute;re napisałeś w fazie Red czy wcześniejszych cyklach TDD, możesz czuć się swobodnie zmieniając istniejący kod. Z większą pewnością możesz zmieniać kod, po każdej zmianie uruchamiając istniejące testy jednostkowe. Takie podejście pozwala&nbsp; Ci bardzo szybko wychwycić potencjalne błędy, kt&oacute;re m&oacute;głbyś wprowadzić refaktoryzacją.</p>
<p>Może się zdarzyć, że faza refaktoryzacji nie zawsze jest konieczna. Usprawnianie dobrego kodu na siłę nie koniecznie może prowadzić do dobrych rezultat&oacute;w.</p>
<h1>Rady praktyczne<&#47;h1><br />
Jedną z pierwszych wątpliwości, kt&oacute;re mi się nasunęły gdy uczyłem się tego podejścia było &ndash; jak &bdquo;długie&rdquo; powinny być takie cykle? Jak duży fragment kodu powinienem testować pojedynczym testem?</p>
<p>Na początku byłem zagorzałym fanem wyznawania możliwie jak najkr&oacute;tszych cykli, wielkiej liczby test&oacute;w, kt&oacute;re testują bardzo mały wycinek kodu (w sumie takie jest jedno z założeń TDD). Takie podejście jest dobre, ma jednak swoje wady. Wymaga od programisty napisania bardzo dużej liczby test&oacute;w jednostkowych. Dużej liczby cykli red-green-refactor. Nie jest to złe, wręcz przeciwnie. Jednak ja ze wszystkim nie możemy popadać w skrajności.</p>
<p>Uważam, że cykle powinny być na tyle długie, że Ty jako programista czujesz się swobodnie. Czujesz, że masz kontrolę nad tym co się dzieje. Ogarniasz to co trzeba napisać aby ten test przeszedł. I na końcu ale &ndash; powinny być na tyle długie, że programista czuje, że kontroluje całość ale ani trochę dłuższe ;). Innymi słowy, moim zdaniem wraz z doświadczeniem przychodzi swego rodzaju wyczucie jak "duży" powinien być cykl.</p>
<p>Nie możesz zapominać o uruchamianiu wszystkich test&oacute;w jednostkowych podczas fazy refaktoryzacji. Może się zdarzyć tak, że drobna zmiana może powodować błędy w innej części programu. Uruchamianie wszystkich test&oacute;w pomaga wykryć taką sytuację.</p>
<p>Pamiętaj też o dobrych praktykach podczas pisania test&oacute;w, opisałem je w artykule poświęconym tematyce <a href="http:&#47;&#47;www.samouczekprogramisty.pl&#47;testy-jednostkowe-z-junit&#47;">test&oacute;w jednostkowych<&#47;a>. Przy TDD praktyki te jak najbardziej obowiązują.</p>
<p>Jeśli używasz repozytorium kodu, to udostępniaj w nim kod, kt&oacute;ry jest poprawny. Innymi słowy udostępniaj kod, kt&oacute;ry jest zakończeniem pełnego cyklu. Kod się kompiluje i wszystkie testy przechodzą. Sytuacja, w kt&oacute;rej zmieniasz kod innego programisty, kt&oacute;ry się nie kompiluje lub nie przechodzą w nim testy potrafi być dość frustrująca. Lepiej jest unikać takich sytuacji ;).</p>
<p>W moim przypadku bardzo dobrze sprawdza się praktyka, w kt&oacute;rej na koniec dnia zostawiam test jednostkowy, kt&oacute;ry nie przechodzi (nie udostępniając go w repozytorium kodu). Następnego dnia rano dokładnie wiem od czego mam zacząć. Takie podejście pomaga mi w następnym dniu pracy od razu skupić się na funkcjonalności, kt&oacute;rą zaplanowałem dzień wcześniej.</p>
<p>Pamiętaj o tym, że faza refaktoringu dotyczy także test&oacute;w. Czasami testy także można oczyścić wprowadzając odpowiednie metody, czy stałe statyczne. Także tutaj trzeba unikać duplikacji. Może część test&oacute;w jest niepotrzebna, bo to samo jest testowane w innym miejscu? Jeśli tak, śmiało można usunąć jeden z takich test&oacute;w.</p>
<h2>Skr&oacute;ty klawiaturowe<&#47;h2><br />
Zachęcam do przejrzenia skr&oacute;t&oacute;w, kt&oacute;re opisałem w <a href="http:&#47;&#47;www.samouczekprogramisty.pl&#47;testy-jednostkowe-z-junit&#47;">poprzednim artykule<&#47;a>. Tutaj dodam jeszcze <code>Ctrl+F5<&#47;code>. Skr&oacute;t ten uruchamia dokładnie to samo, co poprzednie uruchomienie. Innymi słowy jeśli poprzednio uruchomiłeś testy w pakiecie <code>Ctrl+F5<&#47;code> uruchomi je ponownie. Jeśli uruchomiłeś tylko pojedynczy test jednostkowy skr&oacute;t ten uruchomi go jeszcze raz.</p>
<p>Jest on bardzo pomocny przy fazie refaktoryzacji. Będąc wewnątrz klasy, kt&oacute;rą refaktoryzujesz możesz używać tego skr&oacute;tu po każdej, najmniejszej zmianie, IDE uruchomi poprzedni zestaw test&oacute;w automatycznie.</p>
<h1>Dodatkowe materiały do nauki<&#47;h1><br />
Bez najmniejszego wahania mogę polecić książkę autorstwa Kent&rsquo;a Beck&rsquo;a, <a href="http:&#47;&#47;www.samouczekprogramisty.pl&#47;ksiazka-beck-tdd" target="_blank">Test Driven Development by Example<&#47;a>. W książce tej autor na podstawie problemu do rozwiązania pokazuje krok po kroku jak wygląda technika TDD. Chociaż książka nie jest zbyt obszerna, zawiera także sporo informacji związanych z tematyką test&oacute;w jednostkowych.</p>
<p>Co prawda, nie jest to książka najnowsza, jednak moim zdaniem jak najbardziej warta przeczytania. Mogę powiedzieć, że sam uczyłem się TDD z tej książki :).</p>
<h1>Zadanie<&#47;h1><br />
Na koniec czeka na Ciebie zadanie praktyczne. Przećwiczysz w nim TDD na przykładzie. Po tym zadaniu będziesz m&oacute;gł śmiało powiedzieć, że napisałeś program używając TDD :).</p>
<p>Zacznijmy od wymagań, kt&oacute;re nasz program ma spełniać. Ma to być program, kt&oacute;ry przechowuje oceny jednego ucznia. Poniższe punkty opisują wymagania:</p>
<ul>
<li>Jako nauczyciel chcę dodawać przedmioty do dzienniczka,<&#47;li>
<li>jako nauczyciel chcę dodać ocenę dla jednego z przedmiot&oacute;w,<&#47;li>
<li>jako nauczyciel chcę policzyć średnią ocen dla danego przedmiotu,<&#47;li>
<li>jako nauczyciel chcę policzyć średnią ocen z wszystkich przedmiot&oacute;w.<&#47;li><br />
<&#47;ul><br />
Pisząc ten program użyję dw&oacute;ch klas <code>GradeBook<&#47;code> reprezentującej dzienniczek oraz klasy <code>Subject<&#47;code>, kt&oacute;ra będzie opisywała przedmiot.</p>
<p>Te wymagania podzielę na kilka etap&oacute;w. Staraj się postępować zgodnie z nimi. W każdym z tych etap&oacute;w możesz mieć kilka cykli, w kt&oacute;rych dodawał będziesz kolejne testy jednostkowe:</p>
<ol>
<li>Utworzenie dzienniczka,<&#47;li>
<li>utworzenie przedmiotu,<&#47;li>
<li>dodanie przedmiotu do dzienniczka,<&#47;li>
<li>pobranie przedmiotu z dzienniczka,<&#47;li>
<li>dodanie oceny do przedmiotu,<&#47;li>
<li>obliczenie średniej dla przedmiotu,<&#47;li>
<li>obliczenie średniej dla dzienniczka.<&#47;li><br />
<&#47;ol><br />
Przygotowałem też dla Ciebie <a href="https:&#47;&#47;github.com&#47;SamouczekProgramisty&#47;StrefaZadaniowaSamouka&#47;tree&#47;master&#47;04_grade_book" target="_blank">przykładowe rozwiązanie<&#47;a>. Proszę jednak żebyś przed sprawdzeniem rozwiązania przeszedł przez wszystkie kroki samodzielnie. Tak nauczysz się dużo więcej. W rozwiązaniu tym starałem się oddzielać każdy krok tak żeby wszystkie cykle wraz z etapami były widoczne. W prawdziwym projekcie oczywiście nie umieszczaj w repozytorium kodu, kt&oacute;ry się nie kompiluje ;).</p>
<p>Przykładowe rozwiązanie nie sprawdza niekt&oacute;rych przypadk&oacute;w brzegowych. Czy Twoja wersja poprawnie zareaguje na przykład na liczenie średniej z pustego dziennika?</p>
<h1>Podsumowanie<&#47;h1><br />
Wiesz czym jest TDD. Jesteś praktykiem TDD, rozwiązałeś zadanie przy użyciu tego sposobu pisania kodu. Wiesz jakie są cykle TDD (i wiesz, że nie wolno zapominać o refaktoryzacji). Skr&oacute;ty klawiaturowe pomagające w pisaniu test&oacute;w masz w jednym paluszku ;).</p>
<p>Dodam po raz kolejny. Testowanie kodu jest bardzo istotnie, nie zapominaj o nim.t</p>
<p>Na koniec mam do Ciebie prośbę. Zależy mi na dotarciu do jak największej liczby czytelnik&oacute;w &ndash; proszę podziel się linkiem do artykułu ze znajomymi, może ktoś z nich chce poznać TDD od praktycznej strony?. Jeśli nie chcesz ominąć kolejnych artykuł&oacute;w możesz polubić moją stronę na facebooku i zapisać się do mojego newslettera ;). Do następnego razu!</p>
<p>[FM_form id="3"]</p>
<p>Zdjęcie dzięki uprzejmości https:&#47;&#47;www.flickr.com&#47;photos&#47;dieter_henkel&#47;9219097456&#47;sizes&#47;l.</p>
