---
layout: post
status: publish
published: true
title: Formatter - formatowanie łańcuchów znaków
author:
  display_name: Marcin Pietraszek
  login: marcin
  email: m.pietraszek@gmail.com
  url: ''
author_login: marcin
author_email: m.pietraszek@gmail.com
excerpt: "W trakcie pracy z łańcuchami znaków bardzo często musimy prezentować
  je odpowiednim formacie. Dzisiejszy artykuł poświęcony będzie właśnie formatowaniu
  łańcuchów znaków. Dodatkowo dowiesz się czym jest lokalizacja i jaki
  ma wpływ na formatowanie. Całość będziesz mógł przećwiczyć rozwiązując ćwiczenie
  związane z formatowaniem.\r\n\r\n"
wordpress_id: 895
wordpress_url: http://www.samouczekprogramisty.pl/?p=895
date: '2017-05-12 23:25:55 +0200'
date_gmt: '2017-05-12 21:25:55 +0200'
categories:
- Kurs programowania Java
- DSP2017
tags: []
comments: []
---
<p>W trakcie pracy z łańcuchami znaków bardzo często musimy prezentować je odpowiednim formacie. Dzisiejszy artykuł poświęcony będzie właśnie formatowaniu łańcuchów znaków. Dodatkowo dowiesz się czym jest lokalizacja i jaki ma wpływ na formatowanie. Całość będziesz mógł przećwiczyć rozwiązując ćwiczenie związane z formatowaniem.</p>
<p><a id="more"></a><a id="more-895"></a></p>
<h1>Formatowanie</h1><br />
Wyobraź sobie, że chcesz pokazać użytkownikowi pewne zestawienie. Dane tego typu wygodnie jest prezentować w formie tabelarycznej. Tak dochodzimy do problemu formatowania. W jaki sposób można taki format uzyskać?</p>
<p>Problem ten można rozwiązać posługując się klasą <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html" target="_blank" rel="noopener noreferrer"><code>Formatter</code></a>. Instancje właśnie tej klasy użyte są w wielu innych miejscach. Na przykład:</p>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/io/PrintWriter.html#format-java.lang.String-java.lang.Object...-" target="_blank" rel="noopener noreferrer"><code>PrintWriter.format</code></a> Wewnątrz tej metody użyty jest <code>Formatter</code>. <code>System.out</code> to instancja klasy <code>PrintWriter</code>. Dzięki temu w bardzo wygodny sposób możesz formatować tekst wypisując go na konsoli używając metody <code>System.out.format</code>,</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#format-java.lang.String-java.lang.Object...-" target="_blank" rel="noopener noreferrer"><code>String.format</code></a> statyczna metoda w klasie <code>String</code>, która pozwala na formatowanie łańcucha znaków. Jej implementacja także bazuje na klasie <code>Formatter</code>.</li><br />
</ul></p>
<h1>Zasada działania formattera</h1><br />
Formatter działa w oparciu o specjalny łańcuch znaków. Ten łańcuch opisuje sam format w jakim dane powinny być sformatowane. Może on wyglądać następująco:</p>
<pre class="lang:default highlight:0 decode:true">%2$08.3f %3$(,08.3f %s<br />
</pre><br />
Nie przeraź się tym przykładem, po przeczytaniu tego artykułu będziesz dokładnie wiedział co ten magiczny wzorek oznacza. Jest on celowo skomplikowany, żeby pokazać Ci możliwości klasy <code>Formatter</code>.</p>
<h1>Łańcuch formatujący</h1><br />
Zacznijmy od prostego przykładu:</p>
<pre class="lang:default decode:true ">Formatter formatter = new Formatter();<br />
formatter.format("Samouczek Programisty istnieje od %d roku. Wszystkie artykuły pisze %s.", 2015, "Marcin");<br />
String formattedString = formatter.toString();<br />
System.out.println(formattedString);</pre><br />
Po uruchomieniu tego fragmentu kodu na konsoli pokaże się:</p>
<pre class="lang:default highlight:0 decode:true ">Samouczek Programisty istnieje od 2015. Wszystkie artykuły pisze Marcin.</pre><br />
Powyższy fragment kodu to nic innego jak utworzenie nowej instancji klasy <code>Formatter</code>. Następnie na tej instancji wywołana jest metoda <code>format</code>. Jako pierwszy argument przyjmuje ona łańcuch formatujący. Następnie może przyjąć zmienną liczbę argumentów, które wykorzystywane są do uzupełniania formatu.<br />
a<br />
W naszym przypadku łańcuchem formatującym jest <code>Samouczek Programisty istnieje od %d roku. Wszystkie artykuły pisze %s.</code>. Natomiast dwa parametry służące do uzupełniania formatu to literały <code>2015</code> i <code>Marcin</code>.</p>
<p>Powyższy fragment można uprościć używając wcześniej wspomnianej metody <code>PrintWriter.format</code>:</p>
<pre class="lang:default decode:true">System.out.format("Samouczek Programisty istnieje od %d roku. Wszystkie artykuły pisze %s.%n", 2015, "Marcin")</pre><br />
W dalszej części artykułu posługiwał będę się tą uproszczoną wersją. Ważne jest żebyś miał jednak świadomość, że pod spodem używana jest instancji klasy <code>Formatter</code>.</p>
<h1>Znaczniki konwersji</h1><br />
Wcześniej użyty łańcuch formatujący to zwykły <code>String</code>, wewnątrz którego znajdują się sekwencje interpretowane w specjalny sposób. Sekwencje te zawsze mają format:</p>
<pre class="lang:default highlight:0 decode:true">%[indeks argumentu$][flagi][szerokość][.precyzja]konwersja</pre><br />
Wszystkie elementy otoczone nawiasami [] są opcjonalne więc w najprostszej wersji znacznik konwersji może mieć format <code>%konwersja</code>. Zwróć jeszcze raz uwagę na łańcuch formatujący</p>
<pre class="lang:default highlight:0 decode:true ">Samouczek Programisty istnieje od %d roku. Wszystkie artykuły pisze %s.</pre><br />
Jak widzisz znajdują się w nim dwa znaczniki konwersji. Są to <code>%d</code> i <code>%s</code>. Odnoszą się one do kolejnych argumentów metody <code>format</code>. W naszym przypadku są to literały <code>2015</code> i <code>Marcin</code>.</p>
<p>Znaczniki konwersji informują instancję klasy <code>Formatter</code> w jaki sposób dodatkowe parametry powinny być sformatowane. Występuje wiele znaczników konwersji, te najczęściej używane podsumowane są w tabeli poniżej:</p>
<table>
<thead>
<tr>
<th>Znacznik</th></p>
<th>Typ argumentu</th></p>
<th>Działanie</th><br />
</tr><br />
</thead></p>
<tbody>
<tr>
<td><code>%b</code></td></p>
<td>dowolny</td></p>
<td>interpretuje argument jako wartość logiczną</td><br />
</tr></p>
<tr>
<td><code>%s</code></td></p>
<td>dowolny</td></p>
<td>interpretuje argument jako łańcuch znaków</td><br />
</tr></p>
<tr>
<td><code>%d</code></td></p>
<td>liczba całkowita</td></p>
<td>interpretuje argument jako liczbę całkowitą</td><br />
</tr></p>
<tr>
<td><code>%o</code></td></p>
<td>liczba całkowita</td></p>
<td>interpretuje argument jako liczbę całkowitą zapisaną w systemie ósemkowym</td><br />
</tr></p>
<tr>
<td><code>%x</code></td></p>
<td>liczba całkowita</td></p>
<td>interpretuje argument jako liczbę całkowitą zapisaną w systemie szesnastkowym</td><br />
</tr></p>
<tr>
<td><code>%f</code></td></p>
<td>liczba zmiennoprzecinkowa</td></p>
<td>interpretuje argument jako liczbę zmiennoprzecinkową</td><br />
</tr></p>
<tr>
<td><code>%%</code></td></p>
<td>-</td></p>
<td>nie potrzebuje argumentu, jest to sposób na umieszczenie znaku <code>%</code> wewnątrz sformatowanego łańcucha znaków</td><br />
</tr></p>
<tr>
<td><code>%n</code></td></p>
<td>-</td></p>
<td>nie potrzebuje argumentu, jest to sposób na umieszczenie znaku nowej linii wewnątrz sformatowanego łańcucha znaków</td><br />
</tr><br />
</tbody><br />
</table></p>
<h2>Indeks argumentu</h2><br />
Metoda format przyjmuje łańcuch formatujący i parametry, które służą do wypełnienia znaczników formatujących. Jeśli chciałbyś użyć, któregoś obiektu wiele razy możesz użyć indeksu argumentu. Indeksy mają także zastosowanie jeśli chciałbyś użyć argumentów w innej kolejności. Numeracja argumentów zaczyna się od 1. Proszę spójrz na przykład poniżej:</p>
<pre class="lang:default decode:true"> System.out.format("[%2$s] [%1$s] [%1$s]", "pierwszy argument", "drugi argument");</pre><br />
Po uruchomieniu tego kodu na konsoli zostanie wyświetlony napis:</p>
<pre class="lang:default highlight:0 decode:true">[drugi argument] [pierwszy argument] [pierwszy argument]</pre><br />
Argument z numerem 1 użyty jest dwa razy, argument 2. użyty jest jako pierwszy w łańcuchu formatującym.</p>
<h2>Szerokość</h2><br />
Możesz także określić minimalną szerokość jaką powinien zająć argument. Domyślnie zostanie on wyrównany do prawej. Proszę spójrz na przykład poniżej:</p>
<pre class="lang:default decode:true ">System.out.format("[%10s] [%3s]", "test", "test");</pre><br />
Pierwszy fragment będzie uzupełniony sześcioma spacjami. Dzieje się tak ponieważ test ma cztery znaki a minimalna szerokość to 10. Zauważ, że w drugiej części gdzie minimalna szerokość to 3 żadne dodatkowe spacje nie zostały dodane.</p>
<pre class="lang:default decode:true">[      test] [test]</pre></p>
<h2>Precyzja</h2><br />
Dodatkowo dla liczb zmiennoprzecinkowych możesz określić precyzję. Dodając ten modyfikator określasz ile liczb po przecinku powinno być wyświetlonych [2. Precyzję można także użyć na przykład wraz z <code>%s</code>, wtedy oznacza to maksymalną liczbę znaków do wyświetlenia.].</p>
<p>Jeśli precyzja zostanie pominięta użyta jest domyślna wartość - sześć miejsc po przecinku. Proszę spójrz na przykład poniżej:</p>
<pre class="lang:default decode:true ">double x = 1.1234567890123;<br />
System.out.format("[%.10f] [%.3f] [%f]", x, x, x);</pre><br />
Na konsoli pokażą się trzy liczby. Pierwsza z nich zawiera 10 liczb po przecinku, druga 3 a ostatnia domyślne 6:</p>
<pre class="lang:default highlight:0 decode:true ">[1.1234567890] [1.123] [1.123457]</pre></p>
<h2>Flagi</h2><br />
Flagi modyfikują zachowanie znaczników konwersji. Poniżej opiszę kilka dostępnych flag:</p>
<ul>
<li><code>-</code> element będzie wyrównany do lewej strony,</li>
<li><code>+</code> liczba zawsze będzie zawierała znak (nawet jeśli jest dodatnia),</li>
<li><code>0</code> liczba będzie uzupełniona 0 do żądanej szerokości,</li>
<li><code>(</code> liczby ujemne nie będą prezentowane ze znakiem,</li>
<li><code>,</code> użyj separatora do grupowania liczb. Separator ten zależy jest od lokalizacji.</li><br />
</ul><br />
Jeden znacznik może zawierać kilka flag. Dodatkowo wszystkie opisane wcześniej elementy mogą być połączone ze sobą.</p>
<h1>Lokalizacja</h1><br />
W uproszczeniu lokalizacja to zbiór reguł, które określają w jaki sposób w należy prezentować dany łańcuch znaków. Można powiedzieć, że jest to swego rodzaju tłumaczenie na reguły obowiązujące w danym kraju/regionie. To lokalizacja ma wpływ na to jak na przykład wyświetlane są na daty czy liczby.</p>
<p>Do tej pory w całym artykule używałem metod, które używały domyślnej lokalizacji, możesz ją uzyskać odwołując się do metody <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Locale.html#getDefault-java.util.Locale.Category-" target="_blank" rel="noopener noreferrer"><code>Locale.getDefault</code></a>. <code>Formatter</code> pozwala także na formatowanie łańcucha znaków używając innych ustawień lokalizacji.</p>
<p>Proszę spójrz na przykład poniżej. Ta sama liczba prezentowana jest używając trzech różnych ustawień lokalizacji. Zwróć uwagę na to, że w każdym przypadku otrzymujemy różne wyniki:</p>
<pre class="lang:default decode:true ">double someNumber = 12345.12;<br />
System.out.format(Locale.US, "%,.2f%n", someNumber);<br />
System.out.format(Locale.GERMAN, "%,.2f%n", someNumber);<br />
System.out.format(Locale.forLanguageTag("PL"), "%,.2f%n", someNumber);</pre></p>
<pre class="lang:default highlight:0 decode:true">12,345.12<br />
12.345,12<br />
12 345,12</pre><br />
Wyniki różnią się separatorem dziesiętnym (<code>.</code> lub <code>,</code>) i separatorem grup liczb (<code>,</code>, <code>.</code> lub <code> </code>).</p>
<h1>Bardziej skomplikowany przykład</h1><br />
Teraz masz już wystarczająco dużo informacji aby zrozumieć pierwszy przykład użyty na początku artykułu. Dla przypomnienia:</p>
<pre class="lang:default highlight:0 decode:true ">%2$08.3f %3$(,08.3f %s</pre><br />
Rozkładając ten łańcuch formatujący na części widzisz trzy znaczniki formatujące:</p>
<ul>
<li><code>%2$08.3f</code>,</li>
<li><code>%3$(,08.3f</code>,</li>
<li><code>%s</code>.</li><br />
</ul><br />
Rozkładając najbardziej skomplikowany z nich <code>%3$(,08.3f</code> na części pierwsze otrzymujemy:</p>
<ul>
<li><code>%3$</code> odwołanie się do trzeciego argumentu,</li>
<li><code>(</code> otoczenie liczb ujemnych nawiasami <code>()</code>,</li>
<li><code>,</code> użycie separatora grup liczb,</li>
<li><code>0</code> uzupełnienie liczby zerami,</li>
<li><code>8</code> ustawienie minimalnej szerokości wyświetlanej liczby na osiem znaków,</li>
<li><code>.3</code> wyświetlenie trzech miejsc dziesiętnych,</li>
<li><code>f</code> konwersja liczby zmiennoprzecinkowej.</li><br />
</ul></p>
<h1>Ćwiczenie do wykonania</h1><br />
Plik CSV zawiera trzy kolumny oddzielone znakiem <code>,</code>. Pierwsza kolumna zawiera imię, druga liczbę zmiennoprzecinkową trzecia dzień tygodnia. Twoim zadaniem jest wczytanie zawartości <a href="https://raw.githubusercontent.com/SamouczekProgramisty/KursJava/master/27_lancuchy_znakow_formatowanie/src/main/resources/test.csv" target="_blank" rel="noopener noreferrer">tego pliku</a> i wyświetlenie jej w formie tabeli. Efekt, który chcesz uzyskać wygląda następująco:</p>
<pre class="lang:default highlight:0 decode:true">| Piotrek  |  123.12 | poniedziałek |<br />
| Tomek    |  321.30 |       wtorek |<br />
| Marcin   | -123.12 |        środa |<br />
| Wojtek   |   -3.12 |     czwartek |</pre><br />
Zachęcam Cię do rozwiązania zadania samodzielnie. Jeśli jednak będziesz miał problem z jego rozwiązaniem przygotowałem dla Ciebie <a href="https://github.com/SamouczekProgramisty/KursJava/blob/master/27_lancuchy_znakow_formatowanie/src/main/java/pl/samouczekprogramisty/kursjava/strings/formatting/ExerciseSolution.java" target="_blank" rel="noopener noreferrer">przykładowe rozwiązanie</a>.</p>
<h1>Dodatkowe materiały do nauki</h1><br />
Artykuł ten to &ldquo;skrót&rdquo; dokumentacji dla klasy klasy <code>Formatter</code>. Jeśli chcesz dowiedzieć się czegoś więcej zachęcam do przeczytania <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html" target="_blank" rel="noopener noreferrer">dokumentacji tej klasy</a>. Dodatkowo możesz także przejrzeć <a href="https://github.com/SamouczekProgramisty/KursJava/blob/master/27_lancuchy_znakow_formatowanie/src/main/java/pl/samouczekprogramisty/kursjava/strings/formatting/StringFormatting.java" target="_blank" rel="noopener noreferrer">kod źródłowy wszystkich przykładów</a> użytych w tym artykule.</p>
<h1>Podsumowanie</h1><br />
W artykule przeczytałeś o formatowaniu łańcuchów znaków. Wiesz jak formatować liczby zmiennoprzecinkowe, poznałeś klasę Formatter wraz miejscami gdzie jest ona używana. Rozwiązując ćwiczenie wykorzystałeś całą wiedzę w praktyce.</p>
<p>Mam nadzieję, że artykuł przypadł Ci do gustu. Jeśli masz jakieś pytania nie wahaj się zadać je w komentarzach. Jeśli nie chcesz pominąć kolejnych artykułów polub Samouczka na facebooku i dopisz się do newslettera. Do następnego razu.</p>
<p>[FM_form id="3"]</p>
<p>Zdjęcie dzięki uprzejmości https://www.flickr.com/photos/pvenegasd/16584479775/sizes/l</p>
